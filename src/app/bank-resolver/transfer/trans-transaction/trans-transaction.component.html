<loading *ngIf="isLoading"></loading>

<div class="row d-flex justify-content-center align-items-center pt-4"
style="background-color: #78c2ad21; min-height: 90vh;">
<div class="col-xs-12 col-sm-12 col-md-11 col-lg-11 shadow mb-2 bg-white p-3 d-flex justify-content-center align-items-center">
  <div>
    <button type="button"  class="btn btn-primary btn-sm ml-1 mr-1" (click)="retrieve()">Retrieve</button>
    <button type="button"  class="btn btn-primary btn-sm ml-1 mr-1"  (click)="save()">Save</button>
    <button type="button"  class="btn btn-primary btn-sm ml-1 mr-1"  (click)="update()">Modify</button>
    <button type="button"  class="btn btn-primary btn-sm ml-1 mr-1"  (click)="clear()">Clear</button>
    <button type="button"  class="btn btn-primary btn-sm ml-1 mr-1"   (click)="delete()">Delete</button>
    <button type="button"  class="btn btn-primary btn-sm ml-1 mr-1"  (click)="closeScreen()" style="position: absolute;right: 10px;">Close</button>
 </div>
</div>
 <div  class="col-xs-12 col-sm-12 col-md-11 col-lg-11 shadow mb-2 bg-white p-3 d-flex justify-content-center align-items-center">
  <div *ngIf="showMsg && showMsg.Show" class="col-xs-12 col-sm-12 col-md-11 col-lg-11 shadow mb-2 bg-white p-3">
      <div class="alert alert-dismissible fade show" role="alert" [ngClass]="{'alert-success': showMsg.Type === 0,
       'alert-warning':showMsg.Type === 1, 'alert-info':showMsg.Type === 2, 'alert-danger':showMsg.Type === 3 }">
        <strong>{{showMsg.Message}}</strong>
        <button type="button" class="close" data-dismiss="alert" (click)="showMsg = null" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
    </div> 
     <div class="row">

        <div class="form-group col-3">
            <small for="trans_date">Trans Date<span class="text-danger">*</span></small>
              <div class="input-group">
              <input type="text" style="height:30px;" placeholder="dd/mm/yyyy" class="form-control" 
              [(ngModel)]="tm_transfer.trf_dt"  bsDatepicker
              [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY', containerClass:'theme-dark-blue' }"
              [isOpen]="isOpenFromDp">
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" style="height:30px;"  type="button" (click)="isOpenFromDp = !isOpenFromDp">
                  <i class="fa fa-calendar" aria-hidden="true"></i>
                </button>
              </div>
            </div>
          </div>
          <div class="form-group col-2">
            <small for="trans_cd">Trans Cd</small>
            <input type="text" [(ngModel)]="tm_transfer.trans_cd" 
                class="form-control form-control-sm text-capitalize" id="trans_cd">
          </div>
          <div class="form-group col-2">
            <small for="approval_status">Status</small>
            <input type="text" [(ngModel)]="tm_transfer.approval_status" disabled
                class="form-control form-control-sm text-capitalize" id="approval_status">
          </div>

            <div class="col-6 border-right">
                <h6 style="background-color: lightskyblue">Debit Transfer Details</h6>
                <section *ngFor="let l of td_deftranstrfList; let i=index">
                  <div class="form-row">
                    <div class="form-group col-2">
                      <small for="debit_ac">Account Type</small>
                      <input type="text" [(ngModel)]="l.cust_acc_type"
                        [disabled]="undefined !== l.gl_acc_code && l.gl_acc_code.length > 0"
                        (focusout)="checkAndSetDebitAccType('cust_acc', l)"
                        class="form-control form-control-sm text-capitalize" id="debit_ac">
                    </div>
  
                    <div class="form-group col-2">
                      <small for="debit_ac_dsc">Account Desc</small>
                      <input type="text" [(ngModel)]="l.cust_acc_desc"  disabled
                        class="form-control form-control-sm text-capitalize" id="debit_ac_dsc">
                    </div>
  
                    <div class="form-group col-3">
                      <small for="debit_ac_no">Account Number</small>
                      <input type="text" [(ngModel)]="l.cust_acc_number"
                        (focusout)="setDebitAccDtls( l)" [disabled]="undefined !== l.gl_acc_code && l.gl_acc_code.length > 0"
                        class="form-control form-control-sm text-capitalize" id="debit_ac_no">
                    </div>
  
                    <div class="form-group col-3">
                      <small for="debit_ac_name">Acc Holder Name</small>
                      <input type="text" disabled [(ngModel)]="l.cust_name"
                        [disabled]="undefined !== l.gl_acc_code && l.gl_acc_code.length > 0"
                        class="form-control form-control-sm text-capitalize" id="debit_ac_name">
                    </div>
  
                    <div class="form-group col-2">
                      <small for="debit_amount">Amount</small>
                      <input type="text" [(ngModel)]="l.amount"
                        (focusout)="checkDebitBalance(l)"
                        class="form-control form-control-sm text-capitalize"
                        [disabled]="!(undefined !== l.cust_acc_type && l.cust_acc_type.length > 0)
                          && !(undefined !== l.gl_acc_code && l.gl_acc_code.length > 0)"
                        id="debit_amount">
                    </div>
  
                  </div>
                  <div class="form-row">
                    <div class="form-group col-2">
                      <small for="debit_gl_ac">GL Code</small>
                      <input [disabled]="undefined !== l.cust_acc_type && l.cust_acc_type.length > 0" type="text"
                      (focusout)="checkAndSetDebitAccType('gl_acc', l)"
                        [(ngModel)]="l.gl_acc_code"
                        class="form-control form-control-sm text-capitalize" id="debit_gl_ac">
                    </div>
  
                    <div class="form-group col-4">
                      <small for="debit_gl_head">GL Head</small>
                      <input type="text" disabled [(ngModel)]="l.gl_acc_desc"
                        class="form-control form-control-sm text-capitalize" id="debit_gl_head">
                    </div>
  
                    <div class="form-group col-3">
                      <small for="Inst_num">Instrument Num</small>
                      <input type="text"  class="form-control form-control-sm text-capitalize"
                        id="Inst_num" [disabled]="undefined !== l.cust_acc_type && l.cust_acc_type.length > 0">
                    </div>
                    <button *ngIf="td_deftranstrfList.length > 1 && (undefined !== l.cust_acc_type || undefined !== l.gl_acc_code  )"
                      type="button" style="height:22px; padding-top: 0px;" class="btn btn-danger btn-sm mt-4"
                    (click)="removeTransfer(l)">
                    <i class="fa fa-minus-circle" aria-hidden="true"></i>
                    </button>
                  </div>
                  <hr/>
                </section>
                <div class="text-right mb-3">
                  <div class="form-group">
                    <small for="trf_total_amt">Total</small>
                    <input type="text" disabled [(ngModel)]="TrfTotAmt"
                      class="form-control form-control-sm text-capitalize" id="trf_total_amt">
                      <button type="button" style="height:22px; padding-top: 0px;" class="btn btn-primary btn-sm mr-1"
                      (click)="addTransfer()" title="Add transfer">
                      <i class="fa fa-plus-circle" aria-hidden="true"></i>
                    </button>
                    </div>
  
                </div>
            </div>





            <div class="col-6 border-left">
                <h6 style="background-color: lightskyblue">Credit Transfer Details</h6>
                <section *ngFor="let l of cr_td_deftranstrfList; let i=index">
                  <div class="form-row">
                    <div class="form-group col-2">
                      <small for="credit_ac">Account Type</small>
                      <input type="text" [(ngModel)]="l.cust_acc_type"
                        [disabled]="undefined !== l.gl_acc_code && l.gl_acc_code.length > 0"
                        (focusout)="checkAndSetCreditAccType('cust_acc', l)"
                        class="form-control form-control-sm text-capitalize" id="credit_ac">
                    </div>
  
                    <div class="form-group col-2">
                      <small for="credit_ac_dsc">Account Desc</small>
                      <input type="text" [(ngModel)]="l.cust_acc_desc"  disabled
                        class="form-control form-control-sm text-capitalize" id="credit_ac_dsc">
                    </div>
  
                    <div class="form-group col-3">
                      <small for="credit_ac_no">Account Number</small>
                      <input type="text" [(ngModel)]="l.cust_acc_number"
                        (focusout)="setCreditAccDtls( l)" [disabled]="undefined !== l.gl_acc_code && l.gl_acc_code.length > 0"
                        class="form-control form-control-sm text-capitalize" id="credit_ac_no">
                    </div>
  
                    <div class="form-group col-3">
                      <small for="credit_ac_name">Acc Holder Name</small>
                      <input type="text" disabled [(ngModel)]="l.cust_name"
                        [disabled]="undefined !== l.gl_acc_code && l.gl_acc_code.length > 0"
                        class="form-control form-control-sm text-capitalize" id="credit_ac_name">
                    </div>
  
                    <div class="form-group col-2">
                      <small for="credit_amount">Amount</small>
                      <input type="text" [(ngModel)]="l.amount"
                        (focusout)="checkCreditBalance(l)"
                        class="form-control form-control-sm text-capitalize"
                        [disabled]="!(undefined !== l.cust_acc_type && l.cust_acc_type.length > 0)
                          && !(undefined !== l.gl_acc_code && l.gl_acc_code.length > 0)"
                        id="credit_amount">
                    </div>
  
                  </div>
                  <div class="form-row">
                    <div class="form-group col-2">
                      <small for="credit_gl_ac">GL Code</small>
                      <input [disabled]="undefined !== l.cust_acc_type && l.cust_acc_type.length > 0" type="text"
                      (focusout)="checkAndSetCreditAccType('gl_acc', l)"
                        [(ngModel)]="l.gl_acc_code"
                        class="form-control form-control-sm text-capitalize" id="credit_gl_ac">
                    </div>
  
                    <div class="form-group col-4">
                      <small for="credit_gl_head">GL Head</small>
                      <input type="text" disabled [(ngModel)]="l.gl_acc_desc"
                        class="form-control form-control-sm text-capitalize" id="credit_gl_head">
                    </div>
  
                    <div class="form-group col-3">
                      <small for="Cr_Inst_num">Instrument Num</small>
                      <input type="text"  class="form-control form-control-sm text-capitalize"
                        id="Cr_Inst_num" [disabled]="undefined !== l.cust_acc_type && l.cust_acc_type.length > 0">
                    </div>
                    <button *ngIf="cr_td_deftranstrfList.length > 1 && (undefined !== l.cust_acc_type || undefined !== l.gl_acc_code  )"
                      type="button" style="height:22px; padding-top: 0px;" class="btn btn-danger btn-sm mt-4"
                    (click)="CrremoveTransfer(l)">
                    <i class="fa fa-minus-circle" aria-hidden="true"></i>
                    </button>
                  </div>
                  <hr/>
                </section>
                <div class="text-right mb-3">
                  <div class="form-group">
                    <small for="cr_trf_total_amt">Total</small>
                    <input type="text" disabled [(ngModel)]="CrTrfTotAmt"
                      class="form-control form-control-sm text-capitalize" id="cr_trf_total_amt">
                      <button type="button" style="height:22px; padding-top: 0px;" class="btn btn-primary btn-sm mr-1"
                      (click)="CraddTransfer()" title="Add transfer">
                      <i class="fa fa-plus-circle" aria-hidden="true"></i>
                    </button>
                    </div>
  
                </div>
            </div>



        </div>
</div>

<div class="col-xs-12 col-sm-12 col-md-11 col-lg-11 shadow mb-2 bg-white p-3 d-flex justify-content-center align-items-center">
  <div>
    <button type="button"  class="btn btn-primary btn-sm ml-1 mr-1" (click)="retrieve()">Retrieve</button>
    <button type="button"  class="btn btn-primary btn-sm ml-1 mr-1"  (click)="save()">Save</button>
    <button type="button"  class="btn btn-primary btn-sm ml-1 mr-1"  (click)="update()">Modify</button>
    <button type="button"  class="btn btn-primary btn-sm ml-1 mr-1"  (click)="clear()">Clear</button>
    <button type="button"  class="btn btn-primary btn-sm ml-1 mr-1"   (click)="delete()">Delete</button>
    <button type="button"  class="btn btn-primary btn-sm ml-1 mr-1"  (click)="closeScreen()" style="position: absolute;right: 10px;">Close</button>
  </div>
</div>
  </div>
  
 